{% extends 'base.html' %}
{% load static %}
{% block title %}Qubits HRMS | Estimates{% endblock %}
{% block content %}
<div class="content container-fluid">

    <!-- Page Header -->
    <div class="page-header">
        <div class="row align-items-center">
            <div class="col">
                <h3 class="page-title">Estimate</h3>
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Accounts</a></li>
                    <li class="breadcrumb-item active">Estimate</li>
                </ul>
            </div>
        </div>
    </div>
    <!-- /Page Header -->
    {% if messages %}
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
{% endif %}
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <!-- Estimate Details Section -->
                    <div class="row mb-4 align-items-start pb-4">
    <!-- Left Column: Estimate + Client Info -->
    <div class="col-sm-6">
        <!-- Estimate Details -->
        <h3 class="text-uppercase mb-1">Estimate #{{ estimate.estimate_number }}</h3>
        <ul class="list-unstyled mb-3">
            <li><strong>Create Date:</strong> {{ estimate.estimate_date }}</li>
            <li><strong>Expiry Date:</strong> {{ estimate.expiry_date }}</li>
        </ul>

        <!-- Client Information -->
        <h5 class="mt-3">Estimate to:</h5>
        <ul class="list-unstyled">
            <li><h5><strong>{{ estimate.client.client_name }}</strong></h5></li>
            <li>{{ estimate.client.address }}</li>
            <li>{{ estimate.client.city }}</li>
            <li>{{ estimate.client.country }}</li>
            <li>{{ estimate.client.phone }}</li>
            <li><a href="mailto:{{ estimate.client.email }}">{{ estimate.client.email }}</a></li>
        </ul>
    </div>

    <!-- Right Column: Company Logo & Info -->
    <div class="col-sm-6 text-sm-end text-center">
        {% if request.user.company.logo %}
            <img src="{{ request.user.company.logo.url }}" alt="Company Logo" width="120" class="mb-2">
        {% else %}
            <img src="{% static 'images/default_logo.png' %}" alt="Default Logo" width="120" class="mb-2">
        {% endif %}

        <p class="mb-0"><strong>{{ request.user.company.name }}</strong></p>
        <p class="mb-0">{{ request.user.company.address }}</p>
        <p class="mb-0">{{ request.user.company.phone }}</p>
        <p class="mb-0">{{ request.user.company.email }}</p>
    </div>
</div>

    
                    <!-- Estimate Items Table Section -->
                    <div class="table-responsive mb-4">
                        <table class="table table-striped table-hover">
                            <thead>
                                <tr>
                                    <th>SL.No.</th>
                                    <th>Item</th>
                                    <th class="d-none d-sm-table-cell">Description</th>
                                    <th>Unit Cost</th>
                                    <th>Quantity</th>
                                    <th class="text-right">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in items %}
                                <tr>
                                    <td>{{ forloop.counter }}</td>
                                    <td>{{ item.item_name }}</td>
                                    <td class="d-none d-sm-table-cell">{{ item.description }}</td>
                                    <td>₹ {{ item.unit_cost }}</td>
                                    <td>{{ item.quantity }}</td>
                                    <td class="text-right">₹{{ item.amount }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
    
                    <!-- Estimate Summary Section -->
                    <div class="row mb-4">
                        <div class="col-md-7">
                            <!-- Additional Info (if needed) -->
                        </div>
                        <div class="col-md-5">
                            <h5>Estimate Summary</h5>
                            <table class="table">
                                <tbody>
                                    <tr>
                                        <th>Subtotal:</th>
                                        <td class="text-right">₹{{ estimate.total_amount }}</td>
                                    </tr>
                                    <tr>
                                        <th>Tax ({{ estimate.tax }}):</th>
                                        <td class="text-right">₹{{ estimate.tax_amount }}</td>
                                    </tr>
                                    <tr>
                                        <th>Discount:</th>
                                        <td class="text-right">{{ estimate.discount }}%</td>
                                    </tr>
                                    <tr>
                                        <th>Grand Total:</th>
                                        <td class="text-right text-primary"><h5>₹ {{ estimate.grand_total }}</h5></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
    
                    <!-- Other Information Section -->
                    <div class="mb-4">
                        <h5>Other Information</h5>
                        <p>{{ estimate.other_information }}</p>
                    </div>
    
                    <!-- Back Button -->
                    <a href="{% url 'estimate_list' %}" class="btn btn-secondary mt-3">Back to Estimates</a>
                </div>
            </div>
        </div>
    </div>    

</div>
{% endblock %}
